<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
        "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap>
	<!-- 根据搜索条件查询  -->
	<select id="findCommoTroubleByMap">
		from CommoTrouble t  where t.delFlag = 0
		<isNotEmpty property="deptCodes">
			<![CDATA[and  t.deptId in (:deptCodes)]]>
		</isNotEmpty>
		<isNotEmpty property="ids">
			<![CDATA[and t.id in (:ids)]]>
		</isNotEmpty>
		<isNotEmpty property="qymc">
			<![CDATA[and t.qymc like :qymc]]>
		</isNotEmpty>
		<isNotEmpty property="jcsj">
			<![CDATA[and t.jcsj like :jcsj]]>
		</isNotEmpty>
		<isNotEmpty property="jcry">
			<![CDATA[and t.jcry like :jcry]]>
		</isNotEmpty>
		<isNotEmpty property="zfws">
			<![CDATA[and t.zfws = :zfws]]>
		</isNotEmpty>
		<isNotEmpty property="shzt">
			<![CDATA[and t.shzt = :shzt]]>
		</isNotEmpty>
		<isNotEmpty property="jcBeginDate">
			<![CDATA[and t.jcsj >= :jcBeginDate]]>
		</isNotEmpty>
		<isNotEmpty property="jcEndDate">
			<![CDATA[and t.jcsj <= :jcEndDate]]>
		</isNotEmpty>
		<isNotEmpty property="wcBeginDate">
			<![CDATA[and t.zgwcsj >= :wcBeginDate]]>
		</isNotEmpty>
		<isNotEmpty property="wcEndDate">
			<![CDATA[and t.zgwcsj <= :wcEndDate]]>
		</isNotEmpty>
		<isNotEmpty property="qyid">
			<![CDATA[and t.qymcId = :qyid]]>
		</isNotEmpty>
		<isNotEmpty property="ifwhpqylx">
			<isNotEmpty property="deptCode">
				<![CDATA[and (t.ifwhpqylx = :ifwhpqylx or t.deptId in (:deptCode) )]]>
			</isNotEmpty>
			<isEmpty property="deptCode">
				<![CDATA[and  t.ifwhpqylx = :ifwhpqylx]]>
			</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="ifzywhqylx">
			<isNotEmpty property="deptCode">
				<![CDATA[and (t.ifzywhqylx = :ifzywhqylx or t.deptId in (:deptCode) )]]>
			</isNotEmpty>
			<isEmpty property="deptCode">
				<![CDATA[and  t.ifzywhqylx = :ifzywhqylx]]>
			</isEmpty>
		</isNotEmpty>
		<isNotEmpty property="ifyhbzjyqy">
			<isNotEmpty property="deptCode">
				<![CDATA[and (t.ifyhbzjyqy = :ifyhbzjyqy or t.deptId in (:deptCode) )]]>
			</isNotEmpty>
			<isEmpty property="deptCode">
				<![CDATA[and  t.ifyhbzjyqy = :ifyhbzjyqy]]>
			</isEmpty>
		</isNotEmpty> 
		<isNotEmpty property="szc">
				<![CDATA[and t.szc = :szc]]>
		</isNotEmpty>
		<isNotEmpty property="deptId">
			<![CDATA[and t.deptId = :deptId]]>
		</isNotEmpty>
		<isNotEmpty property="deptCode">
			<![CDATA[and t.szz like :deptCode]]>
		</isNotEmpty>
		<!--hanxc 20141223 start-->
		<isNotEmpty property="ifzsqy">
			<![CDATA[and t.ifzsqy =:ifzsqy]]>
		</isNotEmpty>
		<isNotEmpty property="isNotZsqy">
			<![CDATA[and (t.ifzsqy != 1 or t.ifzsqy is null) ]]>
		</isNotEmpty>
		<isNotEmpty property="companyType">
			<![CDATA[and ( t.companyType like $companyType$ )]]>
		</isNotEmpty>
		<!--hanxc 20141223 end-->
		order by t.createTime desc
	</select>
	<!-- 查询属于自己的中队的一般安全隐患信息 修改于2013-08-06 查询跟自己关联的企业id信息 -->
	<select id="query_deptList_byMap" parameterClass="java.util.Map" resultClass="java.lang.String">
		select c.row_id from company c 
		where c.basepass = 1 and  c.dwdz1  like concat(#deptCode#,'%')
	</select>
	<!-- 李军 2013-08-05 根据条件查询隐患上报的信息 -->
	<select id="query_rids_byType"  parameterClass="java.util.Map" resultClass="java.lang.String">
		select c.row_id from company c where 1=1 and c.basepass = 1
		<isEqual property="whp" compareValue="1">
			and c.ifwhpqylx  =  1
		</isEqual>
		<isEqual property="zyjk" compareValue="1">
			and c.ifzywhqylx  =  1
		</isEqual>
		<isNotEmpty property="flag">
			<![CDATA[and c.row_id = #flag#]]>
		</isNotEmpty>
	</select>
	<!-- 按企业类型统计隐患数据 2013-11-13 李军 -->
	<select id="query_comomnTrouble_byQylx" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.DeptDataBean">
		select 
		(select count(*) from companybackup cb where cb.basepass = 1 and cb.qylx = c.item_value) as qyTotal,
	       c.item_text as qylx, 
	       (select count(distinct t.qymcid) from commo_trouble t where t.delFlag = 0 and t.qylx = c.item_value
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	      ) as jcqys,
	       (select IFNULL(sum(t.cdcs),0) from commo_trouble t where t.delFlag = 0 and t.qylx = c.item_value
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as cdcs,
	       (select IFNULL(sum(t.yhs),0) from commo_trouble t where t.delFlag = 0 and t.qylx = c.item_value
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as ccyhs,
	       (select IFNULL(sum(t.zdyhs),0) from commo_trouble t where t.delFlag = 0 and t.qylx = c.item_value
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as zdyhs,
	       (select IFNULL(sum(t.yhzgs),0) from commo_trouble t where t.delFlag = 0 and t.qylx = c.item_value
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as wcyhs,
	       (select IFNULL(sum(t.zdyhzgs),0) from commo_trouble t where t.delFlag = 0 and t.qylx = c.item_value  
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as wczdyhs,
	       (select IFNULL(sum(t.zgzj),0) from commo_trouble t where t.delFlag = 0 and t.qylx = c.item_value 
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as zgzj
       from codevalue c where c.code_id = '4028e56c3ff0d189013ff0e6b99e000c' and c.del_flag = 0
	</select>
	<!-- 按企业类型统计隐患数据 2013-11-13 李军 -->
	<select id="query_comomnTrouble_bean_byQylx" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.DeptDataBean">
		select 
		   (select count(*) from companybackup c where c.basepass = 1) as qyTotal,
	       ( select count(distinct t.qymcid) from commo_trouble t  where t.delFlag = 0 
	       	  <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as jcqys,
	       (select IFNULL(sum(t.cdcs),0) from commo_trouble t  where t.delFlag = 0 
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as cdcs,
	       (select IFNULL(sum(t.yhs),0) from commo_trouble t  where t.delFlag = 0  
	       	 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as ccyhs,
	       (select IFNULL(sum(t.zdyhs),0) from commo_trouble t  where t.delFlag = 0 
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as zdyhs,
	       (select IFNULL(sum(t.yhzgs),0) from commo_trouble t  where t.delFlag = 0   
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as wcyhs,
	       (select IFNULL(sum(t.zdyhzgs),0) from commo_trouble t  where t.delFlag = 0 
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as wczdyhs,
	       (select IFNULL(sum(t.zgzj),0) from commo_trouble t  where t.delFlag = 0 
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as zgzj
        from dual
	</select>
	<!-- 按执法文书统计数据 李军 2013-11-14-->
	<select id="query_zfws_data" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.ZfwsData">
		select
			(select count(*) from commo_trouble t1 where t1.delFlag = 0 and t1.zfws = 'A001' 
          	    <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t1.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t1.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
			) as a1,
			(select count(*) from commo_trouble t2 where t2.delFlag = 0 and t2.zfws = 'A002' 
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t2.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t2.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
			) as a2,
			(select count(*) from commo_trouble t3 where t3.delFlag = 0 and t3.zfws = 'A003' 
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t3.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t3.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
			) as a3,
			(select count(*) from commo_trouble t4 where t4.delFlag = 0 and t4.zfws = 'A004' 
          	    <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t4.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t4.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
			) as a4
		from dual
	</select>
	
	<!-- 按乡镇统计一般隐患数据 列表 李军 2013-11-14 -->
	<select id="query_xz_data_list" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.DeptDataBean">
			select (select count(*) from companybackup cb where cb.basepass = 1 and cb.dwdz1 like c.item_value) as qyTotal,
	       c.item_text as szz,
	       (select count(distinct t.qymcid) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	      ) as jcqys,
	       (select IFNULL(sum(t.cdcs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as cdcs,
	       (select IFNULL(sum(t.yhs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as ccyhs,
         (select IFNULL(sum(t.zdyhs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as zdyhs,
         (select IFNULL(sum(t.yhzgs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as wcyhs,
         (select IFNULL(sum(t.zdyhzgs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as wczdyhs,
         (select IFNULL(sum(t.zgzj),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as zgzj,
         (select count(*) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid  and t.zfws = 'A001'
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as xcjcjl,
         (select count(*) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid  and t.zfws = 'A002'
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
         ) as zgzls,
         (select count(*) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid  and t.zfws = 'A003'
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
         ) as qzcs,
         (select count(*) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid  and t.zfws = 'A004'
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.item_value
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.item_value)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
         ) as fcyjs
       
        from codevalue c where c.code_id = '4028e56c4014f290014014f981510003' and c.del_flag = 0
	</select>
	<!-- 按科室统计一般隐患数据 列表 李军 2013-11-14 -->
	<select id="query_xz_data_list_keshi" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.DeptDataBean">
			select (select count(*) from companybackup cb where cb.basepass = 1 and cb.dwdz1 like c.dept_code) as qyTotal,
	       c.dept_name as szz,
	       (select count(distinct t.qymcid) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	      ) as jcqys,
	       (select IFNULL(sum(t.cdcs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as cdcs,
	       (select IFNULL(sum(t.yhs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as ccyhs,
         (select IFNULL(sum(t.zdyhs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as zdyhs,
         (select IFNULL(sum(t.yhzgs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as wcyhs,
         (select IFNULL(sum(t.zdyhzgs),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as wczdyhs,
         (select IFNULL(sum(t.zgzj),0) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as zgzj,
         (select count(*) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid  and t.zfws = 'A001'
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as xcjcjl,
         (select count(*) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid  and t.zfws = 'A002'
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
         ) as zgzls,
         (select count(*) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid  and t.zfws = 'A003'
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
         ) as qzcs,
         (select count(*) from commo_trouble t ,department d where t.delFlag = 0 and d.row_id = t.deptid  and t.zfws = 'A004'
		       <isNotEqual property="data" compareValue="5">
		       		and t.szz = c.dept_code
		       </isNotEqual>
		       <isEqual property="data" compareValue="5">
		       		and instr(d.dept_code,c.dept_code)>0
		       </isEqual>
	       		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
         ) as fcyjs
       
        from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007'
		order by c.dept_code
	</select>
	<!-- 按乡镇统计一般隐患数据 合计 李军 2013-11-14 -->
	<select id="query_xz_data_bean" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.DeptDataBean">
			select 
			(select count(*) from companybackup c where c.basepass = 1 and c.delflag = 0) as qyTotal,
			(select count(distinct t.qymcid) from commo_trouble t where t.delFlag = 0
					<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
					<isNotEmpty property="queryJcsjStart">
						<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
					</isNotEmpty>
					<isNotEmpty property="queryJcsjEnd">
						<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
					</isNotEmpty> 
			) as jcqys,
	       (select IFNULL(sum(t.cdcs),0) from commo_trouble t where t.delFlag = 0
	       		<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
	       		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
	       ) as cdcs,
	       (select IFNULL(sum(t.yhs),0) from commo_trouble t where t.delFlag = 0
	       		<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
             <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as ccyhs,
         (select IFNULL(sum(t.zdyhs),0) from commo_trouble t where t.delFlag = 0
         	<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
             <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as zdyhs,
         (select IFNULL(sum(t.yhzgs),0) from commo_trouble t where t.delFlag = 0
         		<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
               <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as wcyhs,
         (select IFNULL(sum(t.zdyhzgs),0) from commo_trouble t where t.delFlag = 0
         		<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
           		<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as wczdyhs,
         (select IFNULL(sum(t.zgzj),0) from commo_trouble t where t.delFlag = 0
         		<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
         		 <isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as zgzj,
         (select count(*) from commo_trouble t where t.zfws = 'A001' and t.delFlag = 0
         	<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
         	<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as xcjcjl,
         (select count(*) from commo_trouble t where t.zfws = 'A002' and t.delFlag = 0
         	<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
         	<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as zgzls,
         (select count(*) from commo_trouble t where t.zfws = 'A003' and t.delFlag = 0
         	<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
         	<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as qzcs,
         (select count(*) from commo_trouble t where t.zfws = 'A004' and t.delFlag = 0
         	<isEqual property="data" compareValue="5">
		       		and t.deptid in(select c.row_id from department c where length(c.dept_code) != 3 and length(c.dept_code) != 12 and c.dept_code != '033' and  c.dept_name != '乡镇安监中队'  and c.del_flag = 0 and c.dept_code like '002%' and c.dept_code != '002005' and c.dept_code != '002007')
		       		</isEqual>
         	<isNotEmpty property="queryJcsjStart">
					<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty> 
         ) as fcyjs
        from dual
	</select>
	
	<select id="getCommonTroubleQyListByMap" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.QyDataBean">
	select c.companyname as qymc,
	(select IFNULL(sum(t.cdcs),0) from commo_trouble t where t.qymcid = c.companyid and t.delFlag = 0
    	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
     ) as cdcs,
     (select IFNULL(sum(t.yhs),0) from commo_trouble t where t.qymcid = c.companyid and t.delFlag = 0
        <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
     ) as ccyhs,
     (select IFNULL(sum(t.zdyhs),0) from commo_trouble t where t.qymcid = c.companyid and t.delFlag = 0
      	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
     ) as zdyhs,
     (select IFNULL(sum(t.yhzgs),0) from commo_trouble t where t.qymcid = c.companyid and t.delFlag = 0
        <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>   
     ) as wcyhs,
     (select IFNULL(sum(t.zdyhzgs),0) from commo_trouble t where t.qymcid = c.companyid and t.delFlag = 0
   		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
     ) as wczdyhs,
     (select IFNULL(sum(t.zgzj),0) from commo_trouble t where t.qymcid = c.companyid and t.delFlag = 0
         <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
     ) as zgzj
  	from companybackup c where c.delflag = 0 and c.basepass = 1
	
	</select>
	
	<select id="getAllDeptListByMap" parameterClass="java.util.Map" resultClass="com.jshx.module.admin.entity.Department">
	select t.row_id as id,concat(lpad('-', (length(t.dept_code) - 6) / 3, '-'), t.dept_name) as deptName from department t where t.del_flag = 0 and t.dept_code like '002%'
	and length(t.dept_code) > 3 and t.dept_code not like '033%' order by t.dept_code
	</select>
	
	<!-- 按乡镇检查职业危害企业数据 列表 -->
	<select id="query_xzzywh_data_list" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.XzzywhBean">
	
	select 
        (select count(*) from companybackup cb where cb.basepass = 1 and cb.dwdz1 like c.item_value and cb.ifzywhqylx = 1) as qyTotal,
         c.item_text as szz,
         (select count(*) from commo_trouble t  where t.delFlag = 0 and t.ifzywhqylx = 1
         and t.deptid in(select d.row_id from department d where d.dept_name like '%安监中队' and length(d.dept_code)=9)
           and t.szz = c.item_value
           <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as zjwhs,
         (select count(*) from commo_trouble t  where t.delFlag = 0  and t.ifzywhqylx = 1
         and t.deptid in(select d.row_id from department d where d.dept_name like '%安监中队' and length(d.dept_code)=12)
           and t.szz = c.item_value
           <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as cjwhs,
    
         (select count(*) from commo_trouble t  where t.delFlag = 0 and t.ifzywhqylx = 1  and t.zfws = 'A001'
           and t.szz = c.item_value
           <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as xcjcjl,
         
         (select count(*) from commo_trouble t where t.delFlag = 0 and t.ifzywhqylx = 1  and t.zfws = 'A002'
          and t.szz = c.item_value
          <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as zgzls,
         (select count(*) from commo_trouble t where t.delFlag = 0 and t.ifzywhqylx = 1  and t.zfws = 'A003'
          and t.szz = c.item_value
          <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as qzcs,
          (select count(*) from commo_trouble t where t.delFlag = 0 and t.ifzywhqylx = 1 and t.zfws = 'A004'
           and t.szz = c.item_value
           <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as fcyjs,
         
         (select IFNULL(sum(t.yhs),0) from commo_trouble t where t.delFlag = 0 and t.ifzywhqylx = 1
		 and t.szz = c.item_value
		 <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
		      
         ) as yhTotal,
         (select IFNULL(sum(t.yhzgs),0) from commo_trouble t where t.delFlag = 0 and t.ifzywhqylx = 1
		 and t.szz = c.item_value
		<isNotEmpty property="queryJcsjStart">
	    <![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>      
         ) as zgyhs
        from codevalue c where c.code_id = '4028e56c4014f290014014f981510003' and c.del_flag = 0
	</select>
	
	
	
	<!-- 乡镇检查职业危害企业合计 -->
	<select id="query_xzzywh_data_bean" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.XzzywhBean">
	
	select 
        (select count(*) from companybackup cb where cb.basepass = 1  and cb.ifzywhqylx = 1) as qyTotal,
         (select count(*) from commo_trouble t  where t.delFlag = 0 and t.ifzywhqylx = 1
         and t.deptid in(select d.row_id from department d where d.dept_name like '%安监中队' and length(d.dept_code)=9)
          
           <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as zjwhs,
         (select count(*) from commo_trouble t  where t.delFlag = 0  and t.ifzywhqylx = 1
         and t.deptid in(select d.row_id from department d where d.dept_name like '%安监中队' and length(d.dept_code)=12)
         
           <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as cjwhs,
    
         (select count(*) from commo_trouble t where t.delFlag = 0 and t.ifzywhqylx = 1  and t.zfws = 'A001'
        
           <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as xcjcjl,
         
         (select count(*) from commo_trouble t where t.delFlag = 0 and t.ifzywhqylx = 1  and t.zfws = 'A002'
        
          <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as zgzls,
         (select count(*) from commo_trouble t where t.delFlag = 0 and t.ifzywhqylx = 1  and t.zfws = 'A003'
          
          <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as qzcs,
          (select count(*) from commo_trouble t  where t.delFlag = 0 and t.ifzywhqylx = 1  and t.zfws = 'A004'
         
           <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
         ) as fcyjs,
         
         (select IFNULL(sum(t.yhs),0) from commo_trouble t where t.delFlag = 0 and t.ifzywhqylx = 1
		
		 <isNotEmpty property="queryJcsjStart">
			<![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
		      
         ) as yhTotal,
         (select IFNULL(sum(t.zdyhs),0) from commo_trouble t  where t.delFlag = 0 and t.ifzywhqylx = 1
		
		<isNotEmpty property="queryJcsjStart">
	    <![CDATA[and t.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and t.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>      
         ) as zgyhs
	from dual
	
	</select>
	
	<select id="getKsjcListList" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.KsjcBean">
	select t.dept_name as szzname,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A001' and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data1,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A002' and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data2,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A004' and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data3,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A003' and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data4,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data5,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data6,
	(
		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data7,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data8,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data9,
	(
		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	) as data10,
	
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%'))
	) as data16,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')) and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data17,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data19,
	
	
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(	
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data21,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data22,
	(
		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	) as data23,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data24,
	(
	(	
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data25,
	(
		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	)
	) as data26,
	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%'
  	) as data32,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data33,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data35,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(	
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data37,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data38,
	(
  		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data39,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data40,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
  	) as data41,
  	(
  		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data42,
  	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%'
	) as data48,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data49,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data51,
	
	
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data53,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data54,
	(
  		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data55,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data56,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
  	) as data57,
  	(
  		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data58,
  	
  	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))) 
  	) as data64,
  	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))) and 
  		(
  			cb.companyid in
  			(
  				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  			or cb.companyid in
  			(
  				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  			or cb.companyid in
  			(
  				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  		)
  	) as data65,
  	(
  	(
  		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select count(*) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	+ 
  	(
  		select count(*) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data67,
  	(
  	(
  		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+ 
  	(
  		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
 	) as data69,
  	(
  	(
  		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data70,
  	(
    	select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
    	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
    ) as data71,
  
  	(
  	(
  		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	+ 
  	(
  		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data72,
  	(
  	(
  		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
    ) as data73,
    (
    	select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
    	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
    ) as data74,
    (
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%'
	) as data80,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data81,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
		
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data82,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(	
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data83,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3')
	) as data86,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3') and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data87,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data88,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data89,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1
	) as data92,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1 and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data93,
	(
	(	
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data94,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data95
	from department t where t.dept_code in('002001','002002','002003','002004')
	order by t.dept_code
	</select>
	
	
	<select id="getKsjcBean" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.KsjcBean">
		select
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A001' and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data1,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A002' and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data2,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A004' and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data3,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A003' and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data4,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data5,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data6,
	(
		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data7,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data8,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data9,
	(
		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	) as data10,
	
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%'))
	) as data16,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')) and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data17,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data19,
	
	
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(	
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data21,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data22,
	(
		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	) as data23,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data24,
	(
	(	
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004')) 
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data25,
	(
		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	)
	) as data26,
	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%'
  	) as data32,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data33,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data35,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004')) 
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(	
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data37,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data38,
	(
  		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data39,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data40,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
  	) as data41,
  	(
  		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data42,
  	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%'
	) as data48,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data49,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data51,
	
	
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data53,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data54,
	(
  		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data55,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004')) 
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data56,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
  	) as data57,
  	(
  		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data58,
  	
  	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))) 
  	) as data64,
  	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))) and 
  		(
  			cb.companyid in
  			(
  				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  			or cb.companyid in
  			(
  				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  			or cb.companyid in
  			(
  				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  		)
  	) as data65,
  	(
  	(
  		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select count(*) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	+ 
  	(
  		select count(*) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data67,
  	(
  	(
  		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+ 
  	(
  		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
 	) as data69,
  	(
  	(
  		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data70,
  	(
    	select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
    	and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
    	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
    ) as data71,
  
  	(
  	(
  		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	+ 
  	(
  		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data72,
  	(
  	(
  		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
    ) as data73,
    (
    	select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
    	and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
    	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
    ) as data74,
    (
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%'
	) as data80,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data81,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
		
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data82,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(	
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data83,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3')
	) as data86,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3') and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data87,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data88,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data89,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1
	) as data92,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1 and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data93,
	(
	(	
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data94,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004'))
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where t.dept_code in('002001','002002','002003','002004')) 
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data95
	from dual
	</select>
	
	<select id="getXzjcListList" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.KsjcBean">
		select d.item_text as szzname,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A001' and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data1,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A002' and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data2,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A004' and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data3,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A003' and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data4,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data5,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data6,
	(
		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data7,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data8,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data9,
	(
		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	) as data10,
	
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')) and cb.dwdz1 like t.dept_code
	) as data16,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')) and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data17,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data19,
	
	
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(	
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data21,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data22,
	(
		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	) as data23,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data24,
	(
	(	
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data25,
	(
		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	)
	) as data26,
	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%' and cb.dwdz1 like t.dept_code
  	) as data32,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data33,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data35,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(	
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data37,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data38,
	(
  		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data39,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data40,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
  	) as data41,
  	(
  		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data42,
  	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%' and cb.dwdz1 like t.dept_code
	) as data48,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data49,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data51,
	
	
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data53,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data54,
	(
  		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data55,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data56,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
  	) as data57,
  	(
  		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data58,
  	
  	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%')))  and cb.dwdz1 like t.dept_code
  	) as data64,
  	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))) and 
  		(
  			cb.companyid in
  			(
  				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  			or cb.companyid in
  			(
  				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  			or cb.companyid in
  			(
  				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  		)
  	) as data65,
  	(
  	(
  		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select count(*) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	+ 
  	(
  		select count(*) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data67,
  	(
  	(
  		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+ 
  	(
  		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
 	) as data69,
  	(
  	(
  		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data70,
  	(
    	select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
    	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
    ) as data71,
  
  	(
  	(
  		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	+ 
  	(
  		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data72,
  	(
  	(
  		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
    ) as data73,
    (
    	select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid = t.row_id and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
    	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
    ) as data74,
    (
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%' and cb.dwdz1 like t.dept_code
	) as data80,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data81,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
		
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data82,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(	
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data83,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3') and cb.dwdz1 like t.dept_code
	) as data86,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3') and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data87,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data88,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data89,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1 and cb.dwdz1 like t.dept_code
	) as data92,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1 and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid = t.row_id
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data93,
	(
	(	
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data94,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid = t.row_id and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid = t.row_id and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid = t.row_id and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data95
	from codevalue d,department t where d.code_id = '4028e56c4014f290014014f981510003' and d.del_flag = 0 and d.item_value = t.dept_code
	order by d.item_code
	</select>
	
	<select id="getXzjcBean" parameterClass="java.util.Map" resultClass="com.jshx.commonTrouble.entity.KsjcBean">
		select
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A001' and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data1,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A002' and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data2,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A004' and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data3,
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.zfws = 'A003' and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data4,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data5,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data6,
	(
		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) as data7,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data8,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data9,
	(
		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	) as data10,
	
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%'))
	) as data16,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')) and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data17,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data19,
	
	
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(	
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data21,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data22,
	(
		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	) as data23,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data24,
	(
	(	
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9) 
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%')))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data25,
	(
		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and cb.whpqylx like '%2%') or (cb.ifzywhqylx = 1 and cb.zywhqylx like '%1%'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
	)
	) as data26,
	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%'
  	) as data32,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data33,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data35,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9) 
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(	
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data37,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data38,
	(
  		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data39,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data40,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
  	) as data41,
  	(
  		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%4%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data42,
  	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%'
	) as data48,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data49,
	(
	(
		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select count(*) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data51,
	
	
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data53,
	(
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data54,
	(
  		select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data55,
	
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9) 
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data56,
	(
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
  	) as data57,
  	(
  		select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifyhbzjyqy = 1 and cb.yhbzjyqy like '%1%')
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
  	) as data58,
  	
  	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))) 
  	) as data64,
  	(
  		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))) and 
  		(
  			cb.companyid in
  			(
  				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  			or cb.companyid in
  			(
  				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  			or cb.companyid in
  			(
  				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
  			) 
  		)
  	) as data65,
  	(
  	(
  		select count(*) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select count(*) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	+ 
  	(
  		select count(*) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data67,
  	(
  	(
  		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+ 
  	(
  		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
 	) as data69,
  	(
  	(
  		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data70,
  	(
    	select IFNULL(sum(c.yhs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
    	and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
    	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
    ) as data71,
  
  	(
  	(
  		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	+ 
  	(
  		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
  	) as data72,
  	(
  	(
  		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	) 
  	+
  	(
  		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
  		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
  		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
  	)
    ) as data73,
    (
    	select IFNULL(sum(c.yhzgs),0) from gpdb c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
    	and c.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and ((cb.ifwhpqylx = 1 and (cb.whpqylx like '%5%' or cb.whpqylx like '%3%' or cb.whpqylx like '%1%')) or (cb.ifzywhqylx = 1) or (cb.ifyhbzjyqy = 1 and (cb.yhbzjyqy like '%2%' or cb.yhbzjyqy like '%3%'))))
    	<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(c.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty> 
    ) as data74,
    (
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%'
	) as data80,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%' and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data81,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
		
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data82,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(	
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifwhpqylx = 1 and cb.whpqylx like '%5%')
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data83,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3')
	) as data86,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3') and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data87,
	(
	(
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data88,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.aqbzdbjb in ('1','2','3'))
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data89,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1
	) as data92,
	(
		select count(*) from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1 and 
		(
			cb.companyid in
			(
				select c.qymcid from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select m.qymcid from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
			or cb.companyid in
			(
				select g.qyid from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
				<isNotEmpty property="queryJcsjStart">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
				</isNotEmpty>
				<isNotEmpty property="queryJcsjEnd">
					<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
				</isNotEmpty>  
			) 
		)
	) as data93,
	(
	(	
		select IFNULL(sum(c.yhs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+ 
	(
		select IFNULL(sum(m.yhs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data94,
	(
	(
		select IFNULL(sum(c.yhzgs),0) from commo_trouble c where c.delflag = 0 and c.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and c.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and c.jcsj >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and c.jcsj <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	+ 
	(
		select IFNULL(sum(m.zgs),0) from major_trouble m where m.delflag = 0 and m.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9)
		and m.qymcid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(m.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	) 
	+
	(
		select IFNULL(sum(g.yhzgs),0) from gpdb g where g.delflag = 0 and g.deptid in(select t.row_id from department t where  t.dept_name like '%安监中队'  and length(t.dept_code) = 9) 
		and g.qyid in(select cb.companyid from companybackup cb where cb.delflag = 0 and cb.basepass = 1 and cb.ifzywhqylx = 1)
		<isNotEmpty property="queryJcsjStart">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') >= #queryJcsjStart#]]>
		</isNotEmpty>
		<isNotEmpty property="queryJcsjEnd">
			<![CDATA[and date_format(g.createtime,'yyyy-MM-dd') <= #queryJcsjEnd#]]>
		</isNotEmpty>  
	)
	) as data95
	from dual
	</select>
	
	
		<select id="tjcomm" parameterClass="java.util.Map"   resultClass="java.lang.Integer" >
	<isEmpty property="zgwcsj">
		 select  IFNULL(a.counts,0)   from 
	 (
	 select count(*) counts,date_format(t.createtime,'%Y-%m-%d') ct from commo_trouble t   where t.delflag=0  	and  t.zgwcsj is null
	  <![CDATA[
	 and t.szz like #deptCode# 
	 ]]> 
	   group by    date_format(t.createtime,'%Y-%m-%d')
	 ) a
	  right join  (  
	  SELECT 
	  <![CDATA[
	  ADDDATE(y.first, x.d - 1) as d
	  ]]> 
FROM
(
SELECT 1 AS d UNION ALL
SELECT 2 UNION ALL
SELECT 3 UNION ALL
SELECT 4 UNION ALL
SELECT 5 UNION ALL
SELECT 6 UNION ALL
SELECT 7 UNION ALL
SELECT 8 UNION ALL
SELECT 9 UNION ALL
SELECT 10 UNION ALL
SELECT 11 UNION ALL
SELECT 12 UNION ALL
SELECT 13 UNION ALL
SELECT 14 UNION ALL
SELECT 15 UNION ALL
SELECT 16 UNION ALL
SELECT 17 UNION ALL
SELECT 18 UNION ALL
SELECT 19 UNION ALL
SELECT 20 UNION ALL
SELECT 21 UNION ALL
SELECT 22 UNION ALL
SELECT 23 UNION ALL
SELECT 24 UNION ALL
SELECT 25 UNION ALL
SELECT 26 UNION ALL
SELECT 27 UNION ALL
SELECT 28 UNION ALL
SELECT 29 UNION ALL
SELECT 30 UNION ALL
SELECT 31
) x,
(
SELECT 
<![CDATA[
CURDATE() - INTERVAL DAY(CURDATE()) - 1 DAY AS first, 
       DAY(LAST_DAY(CURDATE())) AS last) y
       ]]>   
WHERE 
<![CDATA[
x.d <= y.last
]]> 
	  <!-- SELECT 
	  <![CDATA[
	    date_format(TO_DATE(#cMonth#,'%Y-%m-%d')+LEVEL-1,'%Y-%m-%d') DAY  
	     ]]>
 	 FROM DUAL
  		<![CDATA[ CONNECT BY LEVEL <= date_format(SYSDATE,'dd') ]]>   
	 ORDER BY DAY -->
	 ) b 
 		on a.ct = b.d order by b.d
	
	</isEmpty>
	<isNotEmpty property="zgwcsj">
	
	 select  IFNULL(a.counts,0)   from 
	 (
	 select count(*) counts,date_format(t.updatetime,'%Y-%m-%d') ct from commo_trouble t    where t.delflag=0 and  t.zgwcsj is not null
	 <![CDATA[
	 and t.szz like #deptCode# 
	 ]]> 
	 group by  date_format(t.updatetime,'%Y-%m-%d')
	 ) a
	  right join  (
	  SELECT 
	  <![CDATA[
	  ADDDATE(y.first, x.d - 1) as d
	  ]]> 
FROM
(
SELECT 1 AS d UNION ALL
SELECT 2 UNION ALL
SELECT 3 UNION ALL
SELECT 4 UNION ALL
SELECT 5 UNION ALL
SELECT 6 UNION ALL
SELECT 7 UNION ALL
SELECT 8 UNION ALL
SELECT 9 UNION ALL
SELECT 10 UNION ALL
SELECT 11 UNION ALL
SELECT 12 UNION ALL
SELECT 13 UNION ALL
SELECT 14 UNION ALL
SELECT 15 UNION ALL
SELECT 16 UNION ALL
SELECT 17 UNION ALL
SELECT 18 UNION ALL
SELECT 19 UNION ALL
SELECT 20 UNION ALL
SELECT 21 UNION ALL
SELECT 22 UNION ALL
SELECT 23 UNION ALL
SELECT 24 UNION ALL
SELECT 25 UNION ALL
SELECT 26 UNION ALL
SELECT 27 UNION ALL
SELECT 28 UNION ALL
SELECT 29 UNION ALL
SELECT 30 UNION ALL
SELECT 31
) x,
(
SELECT 
<![CDATA[
CURDATE() - INTERVAL DAY(CURDATE()) - 1 DAY AS first, 
       DAY(LAST_DAY(CURDATE())) AS last) y
       ]]>   
WHERE 
<![CDATA[
x.d <= y.last
]]> 
	 <!--  SELECT 
	  <![CDATA[
	     date_format(TO_DATE(#cMonth#,'YYYYMMDD')+LEVEL-1,'%Y-%m-%d') DAY  
	    ]]>   
 	 FROM DUAL
  		<![CDATA[ CONNECT BY LEVEL <= date_format(SYSDATE,'dd') ]]>   
	 ORDER BY DAY -->
	 ) b 
 		on a.ct = b.d order by b.d
	
	</isNotEmpty>
	
	</select>
</sqlMap>
